pipeline {
  agent {
     docker {
       image 'environ:1.0.0'
       }
  }
  
  stages {
      stage ('clone src code') {
          steps {
              git 'https://github.com/boleque/boxfuse-sample.git'
          }
      }
	
	stage ('create Dockerfile for app deploy') {
          steps {
              sh 'echo "FROM tomcat:9.0-jdk8\nRUN rm -rf $CATALINA_HOME/webapps/\nCOPY target/ $CATALINA_HOME/webapps/" > Dockerfile'
          }
      }
      
    stage ('deploy') {
        steps {
            echo 'deploy'
            sh 'docker build -t boxfuse:1.0.0 .'
        }
        
    }
  }
}
